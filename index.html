<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login & Movies</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <!-- Login Page -->
    <div class="container" id="loginPage">
        <div class="card">
            <h2>Login</h2>
            <input type="email" id="email" placeholder="Enter Email" required /><br />
            <input type="password" id="password" placeholder="Enter Password" required /><br />
            <button onclick="login()">Login</button>
            <p id="errorMsg" style="color: red;"></p>
        </div>
    </div>

    <!-- Movie Page -->
    <div id="moviePage">
        <h1 style="text-align: center;">ðŸŽ¥ Movie Search</h1>
        <div style="text-align: center; margin-bottom: 20px;">
            <input type="text" id="searchInput" placeholder="Enter movie name" />
            <button onclick="searchMovies()">Search</button>
        </div>
        <ul id="movieList">Movies will appear here</ul>
    </div>

    <script>
        const apiKey = "33583da4"; // Replace with your OMDb API key

        async function login() {
            const email = document.getElementById("email").value.trim();
            const password = document.getElementById("password").value.trim();
            const errorMsg = document.getElementById("errorMsg");

            try {
                const res = await fetch("users.json");
                const users = await res.json();

                const user = users.find(u => u.email === email && u.password === password);

                if (user) {
                    document.getElementById("loginPage").style.display = "none";
                    document.getElementById("moviePage").style.display = "block";
                } else {
                    errorMsg.textContent = "Invalid email or password";
                }
            } catch (err) {
                console.error("Error loading users.json:", err);
                errorMsg.textContent = "Failed to load user data.";
            }
        }

        async function searchMovies() {
            const searchTerm = document.getElementById("searchInput").value.trim();
            const apiUrl = `https://www.omdbapi.com/?apikey=${apiKey}&s=${searchTerm}`;

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();

                const movieList = document.getElementById("movieList");
                movieList.innerHTML = "";

                if (data.Response === "True") {
                    data.Search.forEach(movie => {
                        const li = document.createElement("li");
                        li.classList.add("movie-card");
                        li.innerHTML = `
              <img src="${movie.Poster !== "N/A" ? movie.Poster : 'https://via.placeholder.com/200x300?text=No+Image'}" alt="${movie.Title}">
              <h3>${movie.Title}</h3>
              <p><i>Year: ${movie.Year}</i></p>
            `;
                        movieList.appendChild(li);
                    });
                } else {
                    movieList.innerHTML = `<li>No movies found for "${searchTerm}"</li>`;
                }
            } catch (error) {
                console.error("Error fetching movies:", error);
            }
        }
    </script>
</body>

</html>